/**
 * Copyright (c) 2015-present, Facebook, Inc.
 * All rights reserved.
 *
 * This source code is licensed under the BSD-style license found in the
 * LICENSE file in the root directory of this source tree. An additional grant
 * of patent rights can be found in the PATENTS file in the same directory.
 *
 * @providesModule MetroListView
 * 
 * @format
 */
'use strict';

var ListView=require('ListView');
var React=require('React');
var RefreshControl=require('RefreshControl');
var ScrollView=require('ScrollView');

var invariant=require('fbjs/lib/invariant');































/* $FlowFixMe - the renderItem passed in from SectionList is optional there but
 * required here */


/**
 * This is just a wrapper around the legacy ListView that matches the new API of FlatList, but with
 * some section support tacked on. It is recommended to just use FlatList directly, this component
 * is mostly for debugging and performance comparison.
 */var
MetroListView=function(_React$Component){babelHelpers.inherits(MetroListView,_React$Component);function MetroListView(){var _ref,_this2=this;var _temp,_this,_ret;babelHelpers.classCallCheck(this,MetroListView);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}return _ret=(_temp=(_this=babelHelpers.possibleConstructorReturn(this,(_ref=MetroListView.__proto__||Object.getPrototypeOf(MetroListView)).call.apply(_ref,[this].concat(args))),_this),_this.





























































state=_this._computeState(_this.props,{
ds:new ListView.DataSource({
rowHasChanged:function rowHasChanged(itemA,itemB){return true;},
sectionHeaderHasChanged:function sectionHeaderHasChanged(){return true;},
getSectionHeaderData:function getSectionHeaderData(dataBlob,sectionID){return(
_this.state.sectionHeaderData[sectionID]);}}),

sectionHeaderData:{}}),_this.


















_captureRef=function(ref){
_this._listRef=ref;
},_this.






















_renderFooter=function(){return React.createElement(_this2.props.FooterComponent,{key:"$footer"});},_this.
_renderRow=function(item,sectionID,rowID,highlightRow){
return _this.props.renderItem({item:item,index:rowID});
},_this.
_renderSectionHeader=function(section,sectionID){var
renderSectionHeader=_this.props.renderSectionHeader;
invariant(
renderSectionHeader,
'Must provide renderSectionHeader with sections prop');

return renderSectionHeader({section:section});
},_this.
_renderSeparator=function(sID,rID){return(
React.createElement(_this2.props.SeparatorComponent,{key:sID+rID}));},_temp),babelHelpers.possibleConstructorReturn(_this,_ret);}babelHelpers.createClass(MetroListView,[{key:"scrollToEnd",value:function scrollToEnd(params){throw new Error('scrollToEnd not supported in legacy ListView.');}},{key:"scrollToIndex",value:function scrollToIndex(params){throw new Error('scrollToIndex not supported in legacy ListView.');}},{key:"scrollToItem",value:function scrollToItem(params){throw new Error('scrollToItem not supported in legacy ListView.');}},{key:"scrollToLocation",value:function scrollToLocation(params){throw new Error('scrollToLocation not supported in legacy ListView.');}},{key:"scrollToOffset",value:function scrollToOffset(params){var animated=params.animated,offset=params.offset;this._listRef.scrollTo(this.props.horizontal?{x:offset,animated:animated}:{y:offset,animated:animated});}},{key:"getListRef",value:function getListRef(){return this._listRef;}},{key:"setNativeProps",value:function setNativeProps(props){if(this._listRef){this._listRef.setNativeProps(props);}}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(newProps){var _this3=this;this.setState(function(state){return _this3._computeState(newProps,state);});}},{key:"render",value:function render(){return React.createElement(ListView,babelHelpers.extends({},this.props,{dataSource:this.state.ds,ref:this._captureRef,renderRow:this._renderRow,renderFooter:this.props.FooterComponent&&this._renderFooter,renderSectionHeader:this.props.sections&&this._renderSectionHeader,renderSeparator:this.props.SeparatorComponent&&this._renderSeparator}));}},{key:"_computeState",value:function _computeState(props,state){var sectionHeaderData={};if(props.sections){invariant(!props.items,'Cannot have both sections and items props.');var _sections={};props.sections.forEach(function(sectionIn,ii){var sectionID='s'+ii;_sections[sectionID]=sectionIn.data;sectionHeaderData[sectionID]=sectionIn;});return{ds:state.ds.cloneWithRowsAndSections(_sections),sectionHeaderData:sectionHeaderData};}else{invariant(!props.sections,'Cannot have both sections and items props.');return{ds:state.ds.cloneWithRows(props.items),sectionHeaderData:sectionHeaderData};}}}]);return MetroListView;}(React.Component);MetroListView.defaultProps={keyExtractor:function keyExtractor(item,index){return item.key||String(index);},renderScrollComponent:function renderScrollComponent(props){if(props.onRefresh){return React.createElement(ScrollView,babelHelpers.extends({},props,{refreshControl:React.createElement(RefreshControl,{refreshing:props.refreshing,onRefresh:props.onRefresh})}));}else{return React.createElement(ScrollView,props);}}};


module.exports=MetroListView;